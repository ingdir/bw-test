define("cloud/cloudCtrl",[],function(){function t(t,n){t.forEach(function(t){t.popularity=t[n]})}function n(t,n,r,e){var u=e-r;t.forEach(function(t){t.fontWeight=Math.floor((n-1)*(t.popularity-r)/u),t.modifier=t.sentimentScore>60?"high":t.sentimentScore<40?"low":""})}function r(t){var n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return t.forEach(function(t){t.popularity>=r&&(r=t.popularity),t.popularity<=n&&(n=t.popularity)}),{min:n,max:r}}function e(t){t.sort(function(t,n){return t.popularity>n.popularity?-1:t.popularity<n.popularity?1:0})}function u(u,o){var i=$.extend(!0,[],u||[]);t(i,o);var a=r(i);return n(i,6,a.min,a.max),e(i),i}return{getMinMax:r,assignVisualData:n,sortByPopularity:e,calcPopularity:t,getData:u}}),function(){function t(t){return Function("data,subst",e(r(t)))}var n={PATH:1,SELECTOR:2,OBJ_PRED:3,POS_PRED:4,LOGICAL_EXPR:5,COMPARISON_EXPR:6,MATH_EXPR:7,CONCAT_EXPR:8,UNARY_EXPR:9,POS_EXPR:10,LITERAL:11},r=function(){function t(t){D=t.split(""),M=0,H=null,W=D.length;var n=r(),e=I();return e.type!==z.EOP&&k(e),n}function r(){for(var t,r=e();E("|");)I(),(t||(t=[r])).push(e());return t?{type:n.CONCAT_EXPR,args:t}:r}function e(){return E("(")?u():i()}function u(){R("(");var t=r();R(")");for(var e,u=[];e=o();)u.push(e);return u.length?t.type===n.PATH?(t.parts=t.parts.concat(u),t):(u.unshift(t),{type:n.PATH,parts:u}):t}function o(){return E("[")?f():E("{")?p():E("(")?u():void 0}function i(){O()||k(I());var t,r=!1;E("^")?(I(),r=!0):A()&&(t=I().val.substr(1));for(var e,u=[];e=a();)u.push(e);return{type:n.PATH,fromRoot:r,subst:t,parts:u}}function a(){return T()?s():o()}function s(){var t,r=I().val,e=C();return(E("*")||e.type===z.ID||e.type===z.STR)&&(t=I().val),{type:n.SELECTOR,selector:r,prop:t}}function f(){R("[");var t=y();return R("]"),{type:n.POS_PRED,arg:t}}function p(){R("{");var t=l();return R("}"),{type:n.OBJ_PRED,arg:t}}function l(){for(var t,r=c();E("||");)I(),(t||(t=[r])).push(c());return t?{type:n.LOGICAL_EXPR,op:"||",args:t}:r}function c(){for(var t,r=h();E("&&");)I(),(t||(t=[r])).push(h());return t?{type:n.LOGICAL_EXPR,op:"&&",args:t}:r}function h(){for(var t=d();E("==")||E("!=")||E("===")||E("!==")||E("^=")||E("^==")||E("$==")||E("$=")||E("*==")||E("*=");)t={type:n.COMPARISON_EXPR,op:I().val,args:[t,h()]};return t}function d(){for(var t=v();E("<")||E(">")||E("<=")||E(">=");)t={type:n.COMPARISON_EXPR,op:I().val,args:[t,d()]};return t}function v(){for(var t=g();E("+")||E("-");)t={type:n.MATH_EXPR,op:I().val,args:[t,v()]};return t}function g(){for(var t=P();E("*")||E("/")||E("%");)t={type:n.MATH_EXPR,op:I().val,args:[t,g()]};return t}function y(){if(E(":"))return I(),{type:n.POS_EXPR,toIdx:P()};var t=P();return E(":")?(I(),E("]")?{type:n.POS_EXPR,fromIdx:t}:{type:n.POS_EXPR,fromIdx:t,toIdx:P()}):{type:n.POS_EXPR,idx:t}}function P(){return E("!")||E("-")?{type:n.UNARY_EXPR,op:I().val,arg:P()}:b()}function b(){var t=C(),r=t.type;return r===z.STR||r===z.NUM||r===z.BOOL?{type:n.LITERAL,val:I().val}:O()?i():E("(")?_():k(I())}function _(){R("(");var t=l();return R(")"),t}function E(t){var n=C();return n.type===z.PUNCT&&n.val===t}function O(){return T()||A()||E("^")}function T(){var t=C();if(t.type===z.PUNCT){var n=t.val;return"."===n||".."===n}return!1}function A(){var t=C();return t.type===z.ID&&"$"===t.val[0]}function R(t){var n=I();(n.type!==z.PUNCT||n.val!==t)&&k(n)}function C(){if(null!==H)return H;var t=M;return H=m(),M=t,H}function m(){for(;w(D[M]);)++M;if(M>=W)return{type:z.EOP,range:[M,M]};var t=U();return t||(t=N())||(t=j())||(t=X())?t:(t={range:[M,M]},M>=W?t.type=z.EOP:t.val=D[M],void k(t))}function I(){var t;return H?(M=H.range[1],t=H,H=null,t):m()}function x(t){return"0123456789".indexOf(t)>=0}function w(t){return" "===t}function S(t){return"$"===t||"_"===t||t>="a"&&"z">=t||t>="A"&&"Z">=t}function L(t){return S(t)||t>="0"&&"9">=t}function N(){var t=D[M];if(S(t)){for(var n=M,r=t;++M<W&&(t=D[M],L(t));)r+=t;return"true"===r||"false"===r?{type:z.BOOL,val:"true"===r,range:[n,M]}:{type:z.ID,val:r,range:[n,M]}}}function j(){if('"'===D[M]){for(var t,n=++M,r="",e=!1;W>M;){if(t=D[M++],"\\"===t)t=D[M++];else if('"'===t){e=!0;break}r+=t}return e?{type:z.STR,val:r,range:[n,M]}:void 0}}function X(){var t=M,n=D[M],r="."===n;if(r||x(n)){for(var e=n;++M<W;){if(n=D[M],"."===n){if(r)return;r=!0}else if(!x(n))break;e+=n}return{type:z.NUM,val:r?parseFloat(e):parseInt(e,10),range:[t,M]}}}function U(){var t=M,n=D[M],r=D[M+1];if("."===n){if(x(r))return;return"."===D[++M]?{type:z.PUNCT,val:"..",range:[t,++M]}:{type:z.PUNCT,val:".",range:[t,M]}}if("="===r){var e=D[M+2];if("="===e){if("=!^$*".indexOf(n)>=0)return{type:z.PUNCT,val:n+r+e,range:[t,M+=3]}}else if("=!^$*><".indexOf(n)>=0)return{type:z.PUNCT,val:n+r,range:[t,M+=2]}}return n!==r||"|"!==n&&"&"!==n?":{}()[]^+-*/%!><|".indexOf(n)>=0?{type:z.PUNCT,val:n,range:[t,++M]}:void 0:{type:z.PUNCT,val:n+r,range:[t,M+=2]}}function k(t){t.type===z.EOP&&$(t,B.UNEXP_EOP),$(t,B.UNEXP_TOKEN,t.val)}function $(t,n){var r=Array.prototype.slice.call(arguments,2),e=n.replace(/%(\d)/g,function(t,n){return r[n]||""}),u=new Error(e);throw u.column=t.range[0],u}var D,M,H,W,z={ID:1,NUM:2,STR:3,BOOL:4,PUNCT:5,EOP:6},B={UNEXP_TOKEN:'Unexpected token "%0"',UNEXP_EOP:"Unexpected end of path"};return t}(),e=function(){function t(){if(A.length)return A.shift();var t="v"+ ++T;return O.push(t),t}function r(){for(var t=arguments,n=t.length;n--;)A.push(t[n])}function e(t){if(E=[],O=["res"],T=0,A=[],f(t,"res","data"),E.unshift("var ",Array.isArray?"isArr = Array.isArray":'toStr = Object.prototype.toString, isArr = function(o) { return toStr.call(o) === "[object Array]"; }',",",O.join(","),";"),t.type===n.PATH){var r=t.parts[t.parts.length-1];r&&r.type===n.POS_PRED&&"idx"in r.arg&&E.push("res = res[0];")}return E.push("return res;"),E.join("")}function u(t,r,e){var u=t.parts,f=0,p=u.length;for(E.push(r,"=",t.fromRoot?"data":t.subst?"subst."+t.subst:e,";","isArr("+r+") || ("+r+" = ["+r+"]);");p>f;){var l=u[f++];switch(l.type){case n.SELECTOR:".."===l.selector?i(l,r,r):o(l,r,r);break;case n.OBJ_PRED:a(l,r,r);break;case n.POS_PRED:s(l,r,r);break;case n.CONCAT_EXPR:v(l,r,r)}}}function o(n,e,u){if(n.prop){var o=g(n.prop),i=t(),a=t(),s=t(),f=t(),p=t(),l=t(),c=t();E.push(i,"= [];",a,"= 0;",s,"=",u,".length;",c,"= [];","while(",a,"<",s,") {",f,"=",u,"[",a,"++];","if(",f,"!= null) {"),"*"===n.prop?(E.push("if(typeof ",f,'=== "object") {',"if(isArr(",f,")) {",i,"=",i,".concat(",f,");","}","else {","for(",p," in ",f,") {","if(",f,".hasOwnProperty(",p,")) {",l,"=",f,"[",p,"];"),y(i,l),E.push("}","}","}","}")):(E.push(l,"=",f,"[",o,"];"),y(i,l,c,s)),E.push("}","}",e,"=",s,"> 1 &&",c,".length?",c,".length > 1?",i,".concat.apply(",i,",",c,") :",i,".concat(",c,"[0]) :",i,";"),r(i,a,s,f,p,l,c)}}function i(n,e,u){var o=n.prop,i=t(),a=t(),s=t(),f=t(),p=t(),l=t(),c=t(),h=t();E.push(i,"=",u,".slice(),",h,"= [];","while(",i,".length) {",a,"=",i,".shift();"),o?E.push("if(typeof ",a,'=== "object" &&',a,") {"):E.push("if(typeof ",a,"!= null) {"),E.push(s,"= [];","if(isArr(",a,")) {",f,"= 0,",c,"=",a,".length;","while(",f,"<",c,") {",l,"=",a,"[",f,"++];"),o&&E.push("if(typeof ",l,'=== "object") {'),y(s,l),o&&E.push("}"),E.push("}","}","else {"),o?"*"!==o&&(E.push(l,"=",a,'["'+o+'"];'),y(h,l)):(y(h,a),E.push("if(typeof ",a,'=== "object") {')),E.push("for(",p," in ",a,") {","if(",a,".hasOwnProperty(",p,")) {",l,"=",a,"[",p,"];"),y(s,l),"*"===o&&y(h,l),E.push("}","}"),o||E.push("}"),E.push("}",s,".length &&",i,".unshift.apply(",i,",",s,");","}","}",e,"=",h,";"),r(i,a,s,f,p,l,c,h)}function a(n,e,u){var o=t(),i=t(),a=t(),s=t(),p=t();E.push(o,"= [];",i,"= 0;",a,"=",u,".length;","while(",i,"<",a,") {",p,"=",u,"[",i,"++];"),f(n.arg,s,p),E.push(b(n.arg,s),"&&",o,".push(",p,");","}",e,"=",o,";"),r(o,i,a,p,s)}function s(n,e,u){var o,i,a=n.arg;if(a.idx){var s=t();return f(a.idx,s,u),E.push(s,"< 0 && (",s,"=",u,".length +",s,");",e,"=",u,"[",s,"] == null? [] : [",u,"[",s,"]];"),r(s),!1}a.fromIdx?a.toIdx?(f(a.fromIdx,o=t(),u),f(a.toIdx,i=t(),u),E.push(e,"=",u,".slice(",o,",",i,");"),r(o,i)):(f(a.fromIdx,o=t(),u),E.push(e,"=",u,".slice(",o,");"),r(o)):(f(a.toIdx,i=t(),u),E.push(e,"=",u,".slice(0,",i,");"),r(i))}function f(t,r,e){switch(t.type){case n.PATH:u(t,r,e);break;case n.CONCAT_EXPR:v(t,r,e);break;case n.COMPARISON_EXPR:p(t,r,e);break;case n.MATH_EXPR:h(t,r,e);break;case n.LOGICAL_EXPR:c(t,r,e);break;case n.UNARY_EXPR:d(t,r,e);break;case n.LITERAL:var o=t.val;E.push(r,"=","string"==typeof o?g(o):o,";")}}function p(e,u,o){var i=t(),a=t(),s=t(),p=t(),c=t(),h=t(),d=t(),v=t(),g=e.args[0],y=e.args[1];E.push(u,"= false;"),f(g,i,o),f(y,a,o);var P=g.type===n.PATH,b=y.type===n.LITERAL;E.push(s,"="),P?E.push("true;"):E.push("isArr(",i,");"),E.push(p,"="),b?E.push("false;"):E.push("isArr(",a,");"),E.push("if("),P||E.push(s,"&&"),E.push(i,".length === 1) {",i,"=",i,"[0];",s,"= false;","}"),b||E.push("if(",p,"&&",a,".length === 1) {",a,"=",a,"[0];",p,"= false;","}"),E.push(c,"= 0;","if(",s,") {",d,"=",i,".length;"),b||(E.push("if(",p,") {",v,"=",a,".length;","while(",c,"<",d,"&& !",u,") {",h,"= 0;","while(",h,"<",v,") {"),l(e.op,[i,"[",c,"]"].join(""),[a,"[",h,"]"].join("")),E.push(u,"= true;","break;","}","++",h,";","}","++",c,";","}","}","else {")),E.push("while(",c,"<",d,") {"),l(e.op,[i,"[",c,"]"].join(""),a),E.push(u,"= true;","break;","}","++",c,";","}"),b||E.push("}"),E.push("}"),b||(E.push("else if(",p,") {",v,"=",a,".length;","while(",c,"<",v,") {"),l(e.op,i,[a,"[",c,"]"].join("")),E.push(u,"= true;","break;","}","++",c,";","}","}")),E.push("else {",u,"=",R[e.op](i,a),";","}"),r(i,a,s,p,c,h,d,v)}function l(t,n,r){E.push("if(",R[t](n,r),") {")}function c(n,e,u){var o,i=[],a=n.args,s=a.length,p=0;switch(E.push(e,"= false;"),n.op){case"&&":for(;s>p;)i.push(o=t()),f(a[p],o,u),E.push("if(",b(a[p++],o),") {");E.push(e,"= true;");break;case"||":for(;s>p;)i.push(o=t()),f(a[p],o,u),E.push("if(",b(a[p],o),") {",e,"= true;","}"),p++ +1<s&&E.push("else {");--s}for(;s--;)E.push("}");r.apply(null,i)}function h(n,e,u){var o=t(),i=t(),a=n.args;f(a[0],o,u),f(a[1],i,u),E.push(e,"=",R[n.op](_(a[0],o),_(a[1],i)),";"),r(o,i)}function d(n,e,u){var o=t(),i=n.arg;switch(f(i,o,u),n.op){case"!":E.push(e,"= !",b(i,o)+";");break;case"-":E.push(e,"= -",_(i,o)+";")}r(o)}function v(n,e,u){for(var o=[],i=n.args,a=i.length,s=0;a>s;)o.push(t()),f(i[s],o[s++],u);E.push(e,"= (",e,"= []).concat.call(",e,",",o.join(","),");"),r.apply(null,o)}function g(t){return"'"+t.replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"}function y(t,n,r,e){E.push("if(",n,"!= null) {","if(isArr(",n,")) {"),r&&(E.push(e,"> 1?"),P(r,n),E.push(":")),E.push(t,"=",t,".length? ",t,".concat(",n,") : ",n,";","}","else {"),r&&E.push("if(",r,".length) {",t,"=",t,".concat.apply(",t,",",r,");",r,"= [];","}"),P(t,n),E.push(";","}","}")}function P(t,n){E.push(t,".length?",t,".push(",n,") :",t,"[0] =",n)}function b(t,r){switch(t.type){case n.LOGICAL_EXPR:return r;case n.LITERAL:return"!!"+r;case n.PATH:return r+".length > 0";default:return["(typeof ",r,'=== "boolean"?',r,":","isArr(",r,")?",r,".length > 0 : !!",r,")"].join("")}}function _(t,r){switch(t.type){case n.LITERAL:return r;case n.PATH:return r+"[0]";default:return["(isArr(",r,")?",r,"[0] : ",r,")"].join("")}}var E,O,T,A,R={"===":function(t,n){return t+"==="+n},"==":function(t,n){return["typeof ",t,'=== "string" && typeof ',n,'=== "string"?',t,".toLowerCase() ===",n,".toLowerCase() :"+t,"==",n].join("")},">=":function(t,n){return t+">="+n},">":function(t,n){return t+">"+n},"<=":function(t,n){return t+"<="+n},"<":function(t,n){return t+"<"+n},"!==":function(t,n){return t+"!=="+n},"!=":function(t,n){return t+"!="+n},"^==":function(t,n){return["typeof ",t,'=== "string" && typeof ',n,'=== "string" &&',t,".indexOf(",n,") === 0"].join("")},"^=":function(t,n){return[t,"!= null &&",n,"!= null &&",t,".toString().toLowerCase().indexOf(",n,".toString().toLowerCase()) === 0"].join("")},"$==":function(t,n){return["typeof ",t,'=== "string" && typeof ',n,'=== "string" &&',t,".lastIndexOf(",n,") ===",t,".length -",n,".length"].join("")},"$=":function(t,n){return[t,"!= null &&",n,"!= null &&","(",t,"=",t,".toLowerCase().toString()).indexOf(","(",n,"=",n,".toLowerCase().toLowerCase())) ===",t,".length -",n,".length"].join("")},"*==":function(t,n){return["typeof ",t,'=== "string" && typeof ',n,'=== "string" &&',t,".indexOf(",n,") > -1"].join("")},"*=":function(t,n){return[t,"!= null && ",n,"!= null &&",t,".toString().toLowerCase().indexOf(",n,".toString().toLowerCase()) > -1"].join("")},"+":function(t,n){return t+"+"+n},"-":function(t,n){return t+"-"+n},"*":function(t,n){return t+"*"+n},"/":function(t,n){return t+"/"+n},"%":function(t,n){return t+"%"+n}};return e}(),u={},o=[],i={cacheSize:100},a={cacheSize:function(t,n){if(t>n&&o.length>n)for(var r=o.splice(0,o.length-n),e=r.length;e--;)delete u[r[e]]}},s=function(n,r,e){return u[n]||(u[n]=t(n),o.push(n)>i.cacheSize&&delete u[o.shift()]),u[n](r,e||{})};s.version="0.3.0",s.params=function(t){if(!arguments.length)return i;for(var n in t)t.hasOwnProperty(n)&&(a[n]&&a[n](i[n],t[n]),i[n]=t[n])},s.compile=t,s.apply=s,"object"==typeof module&&"object"==typeof module.exports?module.exports=s:"object"==typeof modules?modules.define("jspath",function(t){t(s)}):"function"==typeof define?define("external/jspath/lib/jspath",["require","exports","module"],function(t,n,r){r.exports=s}):JSPath=s}(),define("cloud/cloudUI",["require","external/jspath/lib/jspath"],function(t){function n(t,n,r){return function(){return t=-t,0>t?n:r}}function r(t,n){if(0===n.length)return!0;var r=0;$(window).off("resize.bwTagCloud").on("resize.bwTagCloud",function(){clearTimeout(r),r=setTimeout(function(){e(t,n)},150)}),t.off("click.bwTagCloud").on("click.bwTagCloud",".b-cloud__word",function(){var r=u("^ {.id === $id}",n,{id:this.getAttribute("data-id")});return r&&r[0]?void t.trigger("cloud:displayWordStats",{label:r[0].label,positive:r[0].sentiment.positive||0,negative:r[0].sentiment.negative||0,neutral:r[0].sentiment.neutral||0}):!0}),e(t,n)}function e(t,r){t.addClass("b-cloud").empty().find(".b-stats").addClass("b-stats_empty");var e=t.outerWidth(),u=n(1,"appendTo","prependTo"),o=function(){return $("<div></div>").data("add",n(1,"appendTo","prependTo")).addClass("b-cloud__row")[u()](t)},i=function(t){return $("<div></div>").addClass("b-cloud__word "+(""!==t.modifier?"b-cloud__word_"+t.modifier:"")).text(t.label).attr({title:t.popularity,"data-id":t.id}).css({fontSize:100+60*t.fontWeight+"%"})},a=function(t,n){var r=t.clone(!0);r[n.data("add")()](n),n.data("add")();var u=n.outerWidth();return r.remove(),e>=u},s=o(),f=s;r.forEach(function(t){var n=i(t);if(!a(n,s)){!a(n,s)&&s.find(".b-cloud__word").length>0&&(f=s,s=o())}n[s.data("add")()](s),n.data("outerWidth",n.outerWidth())})}var u=t("external/jspath/lib/jspath");return{init:r}}),define("stats/statsUI",[],function(){function t(t){t.addClass("b-stats b-stats_empty"),$(document).off("cloud:displayWordStats").on("cloud:displayWordStats",function(n,r){t.removeClass("b-stats_empty"),t.find(".b-stats__word").text(r.label),t.find(".b-stats__positive").text(r.positive||0),t.find(".b-stats__negative").text(r.negative||0),t.find(".b-stats__neutral").text(r.neutral||0),t.find(".b-stats__total").text(["positive","negative","neutral"].reduce(function(t,n){return t+=r[n]||0},0))})}return{init:t}}),define("main/main",["require","cloud/cloudCtrl","cloud/cloudUI","stats/statsUI"],function(t){var n=t("cloud/cloudCtrl"),r=t("cloud/cloudUI"),e=t("stats/statsUI"),u=function(){return $(".b-head__pop").val()},o=$(".b-cloud"),i=$(".b-stats"),a=null;$.ajax({url:"data/stats.json",dataType:"json"}).then(function(t){a=n.getData(t.topics,u()),r.init(o,a),e.init(i),$(".b-head__pop").on("change",function(){a=n.getData(a,u()),r.init(o,a),e.init(i)})},function(){o.text("Error loading data")})}),requirejs(["main/main"]),define("../bw",function(){});